var rijs=function(){"use strict";function n(n,e){return e={exports:{}},n(e,e.exports),e.exports}function e(n){return function(e){return e==n}}function t(n){return function(e){return m(e)(n)}}function r(n,e,t,o){var u=t.shift();if(!Q[e])return!1;if(t.length){if(!(u in n)){if("remove"==e)return!0;n[u]={}}return r(n[u],e,t,o)}return Q[e](n,u,o),!0}function o(n){var e=rn();return C(e),un(e),fn(e),sn(e),N(e),Y(e),T(e),B(e),en(e,n),z(e),e}var u=e;e.fn=function(n){return"function"==typeof n},e.str=function(n){return"string"==typeof n},e.num=function(n){return"number"==typeof n},e.obj=function(n){return"object"==typeof n},e.lit=function(n){return n.constructor==Object},e.bol=function(n){return"boolean"==typeof n},e.truthy=function(n){return 1==!!n},e.falsy=function(n){return 0==!!n},e.arr=function(n){return n instanceof Array},e.null=function(n){return null===n},e.def=function(n){return void 0!==n},e.in=function(n){return function(e){return!!n&&(n.indexOf?~n.indexOf(e):e in n)}},e.promise=function(n){return n instanceof Promise},e.stream=function(n){return!(!n||!n.next)};var i=function(n){return Object.keys(u.obj(n)||u.fn(n)?n:{})},c=function(n,e){return function(t){return e[t]=n[t],t}},a=function(n){return function(e){return i(e).map(c(e,n)),n}},f=function(n){return function(e){return e&&e.indexOf&&~e.indexOf(n)}},s="undefined"!=typeof window,p=function(n){return n.__data__},l=function(n){return function(){return n}},d=function(n){return 0===n?"0":n?u.fn(n)?""+n:u.obj(n)?JSON.stringify(n):String(n):""},m=function n(e,t){var r=arguments.length>1,o=u.fn(e)?[]:d(e).split("."),i=o.shift();return function(c,a){var f={};return c?u.num(e)||e?u.arr(e)?(e.map(function(e){var t=n(e)(c);void 0!=t&&n(e,u.fn(t)?l(t):t)(f)}),f):c[e]||!o.length?r?(c[e]=u.fn(t)?t(c[e],a):t,c):u.fn(e)?e(c):c[e]:r?(n(o.join("."),t)(c[i]?c[i]:c[i]={}),c):n(o.join("."))(c[i]):c:void 0}},h=t;t.parent=function(n){return p(this.parentNode)[n]};var v=function(n){return n?i(n).map(h(n)):[]},y=function n(e,t){var r=arguments.length;return u.str(e)||2!=r?u.str(e)||3!=r?function(n){var o=this||{};return n=o.nodeName||u.fn(o.node)?o:n,n=n.node?n.node():n,n=n.host||n,r>1&&!1===t?n.removeAttribute(e):r>1?(n.setAttribute(e,t),t):n.attributes.getNamedItem(e)&&n.attributes.getNamedItem(e).value}:n(arguments[1],arguments[2]).call(this,arguments[0]):n(arguments[1]).call(this,arguments[0])},g=function(){},b={arr:function(n){return Array.prototype.slice.call(n,0)},obj:function(n){function e(n,e,r){return 0===r&&(n={}),n[u.fn(t)?t(e,r):e[t]]=e,n}var t="id";return 1==arguments.length?(t=n,e):e.apply(this,arguments)}},w=function(n,e){var t=!e&&document.head.createShadowRoot?"html /deep/ ":"";return b.arr((e||document).querySelectorAll(t+n))},x=function(n,e){var t=1==arguments.length;return function(r){var o=u.fn(n)?n(r):m(n)(r);return o&&e&&o.toLowerCase&&e.toLowerCase?o.toLowerCase()===e.toLowerCase():t?Boolean(o):u.fn(e)?e(o):o==e}},O=function(n){return(n||"").toLowerCase()},S=s?window:global,j=function(n){return function(e){if(!S.console||!console.log.apply)return e;u.arr(arguments[2])&&(arguments[2]=arguments[2].length);var t=b.arr(arguments),r="[log]["+(new Date).toISOString()+"]"+n;return t.unshift(r.grey?r.grey:r),console.log.apply(console,t),e}},_=function(n){return function(e){if(!S.console||!console.error.apply)return e;u.arr(arguments[2])&&(arguments[2]=arguments[2].length);var t=b.arr(arguments),r="[err]["+(new Date).toISOString()+"]"+n;return t.unshift(r.red?r.red:r),console.error.apply(console,t),e}},N=n(function(n){n.exports=function(n){return s?(d("creating"),n.draw=Node.prototype.draw=function(n){return function(e){return this&&this.nodeName?o(n)(this):this&&this.node?o(n)(this.node()):e?e instanceof h?o(n)(e.target):e[0]instanceof h?o(n)(e[0].target):e.nodeName?o(n)(e):e.node?o(n)(e.node()):e.name?r(n)(e.name):u.str(e)?r(n)(e):m("could not update",e):t(n)}}(n),n.render=i(n),n.on("change.draw",n.draw),function(n){document.body?n():document.addEventListener("DOMContentLoaded",n.bind(this))}(e(n)),n):n};var e=function(n){return function(){return w("*").filter(x("nodeName",f("-"))).map(n.draw)}},t=function(n){var e=v(n.resources).map(function(e){return(n.types[e.headers["content-type"]].selector||g)(e)}).join(",");return w(e||null).map(o(n))},r=function(n){return function(e){var t=n.resources[e],r=t.headers["content-type"];return w((n.types[r].selector||g)(t)).map(o(n))}},o=function(n){return function(e){if(f("-")(e.nodeName)){if("#document-fragment"==e.nodeName)return o(n)(e.host);if("#text"==e.nodeName)return o(n)(e.parentNode);if(e.matches(b)&&null==y(e,"inert"))return function(n){return function(e){e.pending||(e.pending=[],requestAnimationFrame(function(){e.changes=e.pending,delete e.pending,n.render(e)})),n.change&&e.pending.push(n.change[1])}}(n)(e),e}}},i=function(n){return function(e){var t=e.shadowRoot||e,r=y(e,"data"),o=p(n)(r),u=l(n)(O(e.tagName)),i=u&&u.prototype&&u.prototype.render;if(!u)return e;if(r&&!o)return e;if(i&&t.class!=u)return Object.getOwnPropertyNames((t.class=u).prototype).map(function(n){return t[n]=u.prototype[n].bind(t)}),Promise.resolve((t.init||g).call(t,t,t.state=t.state||{})).then(function(){return n.draw(t.initialised=t)}),e;if(!i||t.initialised){try{(t.render||u).call(t,t,c(e,o))}catch(n){m(n,n.stack)}return e}}},c=function(n,e){return n.state=n.state||{},a(n.state)(e),a(n.state)(n.__data__),n.__data__=n.state,n.state},p=function(n){return function(e){var t={},r=e?e.split(" "):[];return r.map(function(e){return t[e]=l(n)(e)}),r.length?v(t).some(u.falsy)?void 0:t:void 0}},l=function(n){return function(e){return n.resources[e]&&n.resources[e].body}},d=j("[ri/components]"),m=_("[ri/components]"),h=s&&window.MutationRecord||g,b=s&&!!window.document.registerElement?"html *, :host-context(html) *":"html *";s&&(window.Element.prototype.matches=window.Element.prototype.matches||window.Element.prototype.msMatchesSelector)}),C=function(n){return R("creating"),S.ripple||(S.ripple=n),n},R=j("[ri/singleton]"),E=function(n,e){var t=1==arguments.length;return function(r){return r&&r.headers?t?m(n)(r.headers):m(n)(r.headers)==e:null}},I=function(n){return function(){return!n.apply(this,arguments)}},z=n(function(n){n.exports=function(n){if(s)return t("creating"),n.render=e(n)(n.render),n};var e=function(n){return function(e){return function(t){var r=d(y(t,"is")).split(" ").map(h(n.resources)).filter(E("content-type","application/javascript")),o=d(y("css")(t)).split(" ");r.filter(x("headers.needs",f("[css]"))).map(m("name")).map(function(n){return function(e){return e+n}}(".css")).filter(I(u.in(o))).map(function(n){return y("css",(d(y("css")(t))+" "+n).trim())(t)});var i=e(t);return i&&i.state?(r.map(m("body")).map(function(n){return n.call(i.shadowRoot||i,i.shadowRoot||i,i.state)}),i):void 0}}},t=j("[ri/features]")}),k=function(n){return n&&JSON.parse(n)},A=function(n,e){if(!S.console)return e();console.groupCollapsed||(console.groupCollapsed=console.groupEnd=function(n){(console.log||g)("*****",n,"*****")}),console.groupCollapsed(n);var t=e();return console.groupEnd(n),t},B=function(n){if(s&&window.localStorage)return D("creating"),P(n),n.on("change.cache",function(n){function e(n){return function(){var e=this,o=arguments;t&&clearTimeout(t),t=setTimeout(function(){n.apply(e,o)},r)}}var t,r=u.num(n)?n:100;return u.fn(n)?e(n):e}(1e3)(L(n))),n},P=function(n){return A("loading cache",function(){return(k(localStorage.ripple)||[]).map(n)})},L=function(n){return function(){D("cached");var e=v(function(n){return u.fn(n)||u.str(n)?n:k(d(n))}(n.resources)).filter(I(E("cache","no-store")));e.filter(E("content-type","application/javascript")).map(function(e){return e.body=d(n.resources[e.name].body)}),localStorage.ripple=d(e)}},D=j("[ri/offline]"),T=n(function(n){n.exports=function(n){if(s)return r("creating"),n.render=e(n)(n.render),n};var e=function(n){return function(e){return function(r){var o=d(y(r,"css")).split(" ").filter(Boolean),i=r.shadowRoot||r,c=document.head,a=c.createShadowRoot&&r.shadowRoot;if(!o.length)return e(r);if(!o.some(I(u.in(n.resources))))return o.map(function(e){return{res:n.resources[e],el:function(n,e){var t=!e&&document.head.createShadowRoot?"html /deep/ ":"";return(e||document).querySelector(t+n)}('style[resource="'+e+'"]',a?i:c)||function(n){var e=[],t=n.replace(/\[(.+?)=(.*?)\]/g,function(n,t,r){return e.push([t,r]),""}).split("."),r=t.shift(),o=document.createElement(r);return e.forEach(function(n){y(o,n[0],n[1])}),t.forEach(function(n){o.classList.add(n)}),o.toString=function(){return r+t.map(function(n){return function(e){return n+e}}(".")).join("")},o}("style[resource="+e+"]")}}).filter(function(n){return n.el.hash!=n.res.headers.hash}).map(function(n){return n.el.hash=n.res.headers.hash,n.el.innerHTML=a?n.res.body:t(n.res.body,n.res.name),n.el}).filter(I(x("parentNode"))).map(function(n){return a?i.insertBefore(n,i.firstChild):c.appendChild(n)}),e(r)}}},t=function(n,e){return function(n,e){return n.replace(/^(?!.*:host)([^@%\n]*){/gim,function(n){return e+" "+n}).replace(/^(?!.*:host)(.*?),\s*$/gim,function(n){return e+" "+n}).replace(/:host\((.*?)\)/gi,function(n,t){return e+t}).replace(/:host([ ,])/gi,function(n,t){return e+t}).replace(/^.*:host-context\((.*)\)/gim,function(n,t){return t+" "+e})}(n,'[css~="'+e+'"]')},r=j("[ri/precss]")}),Y=n(function(n){n.exports=function(n){if(s)return r("creating"),n.render=e(n)(n.render),n};var e=function(n){return function(e){return function(r){var o=O(r.nodeName);if(o in n.resources){var u=n.resources[o].headers;return(u.attrs=u.attrs||t(u.needs,o)).map(function(n){var e=n[0];return n[1].map(function(n){var t=y(r,e)||"";return!f(n)(t)&&y(r,e,(t+" "+n).trim())}).some(Boolean)}).some(Boolean)?r.draw():e(r)}}}},t=function(n,e){return void 0===n&&(n=""),n.split("[").slice(1).map(function(n,e){return function(t){return t.replace(n,e)}}("]","")).map(function(n){return function(e){return e.split(n)}}("=")).map(function(n){var t=n[0],r=n[1];return r?[t,r.split(" ")]:"css"==t?[t,[e+".css"]]:[t,[]]})},r=j("[ri/needs]")}),$=function(){var n,e,t=new Promise(function(t,r){n=t,e=r});return arguments.length&&n(arguments[0]),t.resolve=n,t.reject=e,t},F=function n(e,t){return t instanceof Array&&(t=t.reduce(n,[])),(e=e||[]).concat(t)},J=function(n,e,t,r){return n.host&&n.host.nodeName&&(n=n.host),e.name&&(t=e,e=e.name),!function(n,e){return e in n}(n,e)&&Object.defineProperty(n,e,{value:t,writable:r}),n[e]},M=function n(e){function t(n,t){return n.next?n.next(t):t instanceof Array?n.apply(e,t):n.call(e,t)}function r(n,e){for(var t=n.length;~--t;)e!=n[t]&&e!=n[t].fn&&e||n.splice(t,1)}function o(e,t){var u=n((t=t||{}).base||$());return u.i=0,u.li=[],u.fn=t.fn,u.parent=e,u.source=t.fn?u.parent.source:u,u.on("stop",function(){return u.type?u.parent.off(u.type,u):u.parent.off(u)}),u.each=function(n){var e=n.next?n:o(u,{fn:n});return u.li.push(e),e},u.pipe=function(n){return n(u)},u.map=function(n){return u.each(function(e,t,r){return r.next(n(e,t,r))})},u.filter=function(n){return u.each(function(e,t,r){return n(e,t,r)&&r.next(e)})},u.reduce=function(n,e){return u.each(function(t,r,o){return o.next(e=n(e,t,r,o))})},u.unpromise=function(){var n=o(u,{base:{},fn:function(e){return n.next(e)}});return u.li.push(n),n},u.next=function(n){return u.resolve&&u.resolve(n),u.li.length?u.li.map(function(e){return e.fn(n,e.i++,e)}):n},u.until=function(n){return n.each(function(){u.source.emit("stop")}),u},u.off=function(n){return r(u.li,n),u},u[Symbol.asyncIterator]=function(){return{next:function(){return u.wait=new Promise(function(n){u.wait=!0,u.map(function(e,t,r){delete u.wait,u.off(r),n({value:e,done:!1})}),u.emit("pull",u)})}}},u}return e=e||{},J(e,"emit",function(n,r,o){for(var u=e.on[n.split(".")[0]]||[],i=[],c=0;c<u.length;c++)u[c].ns&&o&&!o(u[c].ns)||i.push(t(u[c].isOnce?u.splice(c--,1)[0]:u[c],r));for(c=0;c<e.on["*"].length;c++)i.push(t(e.on["*"][c],[n,r]));return i.reduce(F,[])},1),J(e,"once",function(n,t){return e.on(n,t,!0)},1),J(e,"off",function(n,t){return r(e.on[n]||[],t),t&&t.ns&&delete e.on[n]["$"+t.ns],e},1),J(e,"on",function(n,t,u){function i(n){return n.isOnce=u,n.type=c,a&&(e.on[c]["$"+(n.ns=a)]=n),f.push(n),n.next?n:e}var c=n.split(".")[0],a=n.split(".")[1],f=e.on[c]=e.on[c]||[],s="function"==typeof t?t:0;return!s&&a?(s=e.on[c]["$"+a])?s:i(o(e,t)):s||a?s&&a?i((r(f,e.on[c]["$"+a]||-1),s)):!(!s||a)&&i(s):i(o(e,t))},1),e.on["*"]=e.on["*"]||[],e},U=Math.min,q=Math.pow,H=function(n,e){return function(){var t=window.WebSocket,r=(window.location,window.setTimeout),o=new t(e);o.onopen=function(){return n.emit("connected",o)},o.onmessage=function(e){return n.emit("recv",e.data)},o.onclose=function(){n.ready=n.once("connected"),n.emit("disconnected"),r(n.connect,W(++n.attempt))}}},W=function(n,e,t){return void 0===e&&(e=100),void 0===t&&(t=1e4),U(t,e*q(2,n))},G=n(function(n){!function(){function e(n){return"object"==typeof n?null===n?"null":n&&1===n.nodeType?"dom":n instanceof Array?"array":n instanceof Date?"date":"object":typeof n}function t(n){var e=arguments,t=arguments.length;if(t<2||null==n)return n;for(var r=1;r<t;r++)for(var o=e[r],u=Object.keys(o),i=u.length,c=0;c<i;c++){var a=u[c];void 0===n[a]&&(n[a]=o[a])}return n}function r(n,t,o,i){o.prepare&&o.prepare(n),i=i||[];var f=e(n);if(-1!==c.indexOf(f)){var s=i.indexOf(n);if(-1===s){var p={};i[s=t.push({contents:p,value:function(n){var t=e(n);if("function"===t||"date"===t)return u(n);if("object"===t)return d;if("array"===t)return m;return n}(n)})-1]=n;for(var l in n)o.isSerializable(n,l)&&(p[l]=r(n[l],t,o,i))}return a+s}return u(n)}function o(n,t,r,u){if(u=u||[],i(n,a)){var c=parseInt(n.slice(a.length),10);if(!u.hasOwnProperty(c)){var h=t[c],v=function(n){if("string"===e(n)){if(n===p)return;if(i(n,s))return new Function("return "+n.slice(s.length))();if(i(n,l)){var t=parseInt(n.slice(l.length),10);return new Date(t)}if(i(n,d))return{};if(i(n,m))return[];if(n===f)return 1/0}return n}(h.value),y=h.contents;u[c]=v;for(var g in y)v[g]=o(y[g],t,r,u)}return r.finalize&&r.finalize(u[c]),u[c]}return r.finalize&&r.finalize(n),function(n){if("string"===e(n)){if(n===p)return;if(i(n,s)){var t=n.slice(s.length),r=t.indexOf("(")+1,o=t.indexOf(")",r),u=t.slice(r,o),c=t.indexOf("{")+1,a=t.lastIndexOf("}")-1,d=t.slice(c,a);return new Function(u,d)}if(i(n,l)){var m=parseInt(n.slice(l.length),10);return new Date(m)}if(n===f)return 1/0}return n}(n)}function u(n){var t=e(n);if("undefined"===t)return p;if("function"===t)return s+n.toString();if("date"===t)return l+n.getTime();if(n===1/0)return f;if("dom"!==t)return n}function i(n,t){return"string"===e(n)&&n.slice(0,t.length)===t}var c="object array date function".split(" "),a="_CRYO_REF_",f="_CRYO_INFINITY_",s="_CRYO_FUNCTION_",p="_CRYO_UNDEFINED_",l="_CRYO_DATE_",d="_CRYO_OBJECT_",m="_CRYO_ARRAY_",h={stringify:function(n,e){var o=[],u=r(n,o,e=t((e="function"==typeof e?{prepare:e}:e)||{},{prepare:null,isSerializable:function(n,e){return n.hasOwnProperty(e)}}));return JSON.stringify({root:u,references:o})},parse:function(n,e){var r=JSON.parse(n);return e="function"==typeof e?{finalize:e}:e,e=t(e||{},{finalize:null}),o(r.root,r.references,e)}},v=this;n.exports?n.exports=h:v.Cryo=h}()}),K=n(function(n){n.exports=function(n){void 0===n&&(n={});var u=n.socket;return void 0===u&&(u=function(n){void 0===n&&(n=location.href.replace("http","ws"));var e=M({attempt:0});return e.ready=e.once("connected"),e.connect=H(e,n),e.connect(),e.send=function(n){return e.ready.then(function(e){return e.send(n)})},e}()),u.id=0,u.once("disconnected").map(function(){return u.on("connected").map(t(u))}),u.on("recv").map(function(n){return r(n)}).each(function(n){var e=n.id,t=n.data;return t.exec?t.exec(u.on["$"+e]&&u.on["$"+e][0],t.value):u.emit("$"+e,t)}),Object.defineProperty(o(u),"subscriptions",{get:function(){return e(u)}})};var e=function(n){return v(n.on).map(function(n){return n&&n[0]}).filter(function(n){return n&&n.type&&"$"==n.type[0]})},t=function(n){return function(){return e(n).map(function(n){return n.type}).map(function(e){return n.send(n.on[e][0].subscription)})}},r=G.parse,o=function(n,e){return function(t,r){if(t instanceof window.Blob)return u(n,t,r);var i=d(++n.id),c=n.on("$"+i),a=function(t,r){return void 0===r&&(r=0),n.send(c.source.subscription=d({id:i,data:t,type:e})).then(function(){return c.emit("sent",{id:i,count:r})})};return t.next?t.map(a).source.emit("start"):a(t),c.source.once("stop").filter(function(n){return"CLOSED"!=n}).map(function(){return o(n,"UNSUBSCRIBE")(i).filter(function(n,e,t){return t.source.emit("stop","CLOSED")})}),c}},u=function(n,e,t,r,u){void 0===r&&(r=0),void 0===u&&(u=1024);var i=M().on("recv"),c=function(t){return function(){return r>=e.size?i.emit("sent",{id:t}):(n.send(e.slice(r,r+=u)),window.setTimeout(c(t)))}};return o(n,"BINARY")({size:e.size,meta:t}).on("sent",function(n){var e=n.id;return c(e)()}).on("progress",function(n){return i.emit("progress",{received:n,total:e.size})}).map(i.next).source.until(i.once("stop")),i}}),Q={add:function(n,e,t){u.arr(n)?n.splice(e,0,t):n[e]=t},update:function(n,e,t){n[e]=t},remove:function(n,e){u.arr(n)?n.splice(e,1):delete n[e]}},V=JSON.stringify,X=JSON.parse,Z=function(n,e){return function(t,o,i){if(!u.obj(t)&&!u.fn(t))return t;if(!u.obj(n)){var c=o||t.log||[],a=t;if(u.def(i)||(i=c.max||0),i||(c=[]),i<0&&(c=c.concat(null)),i>0){var f=V(t);a=X(f),c=c.concat({type:"update",value:X(f),time:c.length})}return J(c,"max",i),a.log?a.log=c:J(M(a),"log",c,1),a}return!!u.def(n.key)&&(!!r(t,n.type,(n.key=""+n.key).split("."),n.value)&&(t.log&&t.log.max&&t.log.push((n.time=t.log.length,t.log.max>0?n:null)),!e&&t.emit&&t.emit("change",n),t))}},nn=function(n){return function(e){return i(e).filter(I(u.in(n))).map(c(e,n)),n}},en=n(function(n){n.exports=function(n,r,u){void 0===r&&(r={}),void 0===u&&(u={});var i=u.xrs;return void 0===i&&(i=K),n.send=e(i()),n.subscribe=o(n),n.subscriptions={},n.get=t(n),n.upload=c(n),n.upload.id=0,n.render=f(n)(n.render),n.deps=s(n),n};var e=function(n){return function(e,t,r){return e instanceof Blob?n(e,t):n(u.obj(e)?e:{name:e,type:t,value:r})}},t=function(n){return function(e,t){if(n.subscriptions[e]=n.subscriptions[e]||{},u.arr(t))return Promise.all(t.map(function(t){return n.get(e,t)}));var r=m(t)(m("resources."+e+".body")(n));return t in n.subscriptions[e]&&r?Promise.resolve(r):n.subscribe(e,t).filter(function(n,e,t){return t.source.emit("stop")}).map(function(){return m(t)(m("resources."+e+".body")(n))})}},r=function(n){var e=M().on("next"),t=[];return n.map(function(n,r){return n.each(function(n){t[r]=n,e.next(t)})}),e.once("stop").map(function(){return n.map(function(n){return n.source.emit("stop")})}),e},o=function(n){return function(e,t){if(u.arr(e))return r(e.map(function(e){return n.subscribe(e,t)}));if(n.subscriptions[e]=n.subscriptions[e]||{},u.arr(t))return r(t.map(function(t){return n.subscribe(e,t)})).map(function(){return m(t)(n(e))});var o=M().on("next");o.on("stop").filter(function(){return i.off(o.next)&&!i.li.length}).map(function(){return i.source.emit("stop")}).map(function(){n.subscriptions[e][t]=void 0}),n.subscriptions[e][t]&&o.on("start").map(function(){return m(t)(n(e))}).filter(u.def).map(function(n){return o.next(n)});var i=n.subscriptions[e][t]=n.subscriptions[e][t]||n.send(e,"SUBSCRIBE",t).map(function(n,e){return function(t){return t.key||"update"!=t.type?Z(t)(e in n.resources?n(e):n(e,{})):n(a(nn({name:e})(t))),t}}(n,e)).map(function(){return m(t)(n(e))});return i.each(o.next),o}},c=function(n){return function(e,t){var r=++n.upload.id,o={},u=0,c=function(){if(!a.length)return!0;var e=a.shift(),t=e.field,o=e.filename,i=e.i,s=e.blob;return n.send(s,{filename:o,field:t,i:i,index:r}).on("progress",function(n){var e=n.received;n.total;return f.emit("progress",{total:u,received:u-(s.size-e)-a.reduce(function(n,e){return n+=e.blob.size},0)})}).then(c)},a=i(t).map(function(n){return o[n]=t[n],n}).filter(function(n){return t[n]instanceof FileList}).map(function(n){return o[n]=[],b.arr(t[n]).map(function(n){return u+=n.size,n}).map(function(e,t){return{field:n,filename:e.name,i:t,blob:e,sent:0}})}).reduce(F,[]),f=n.send({files:a.length,type:"PREUPLOAD",fields:o,index:r,size:u,name:e}).once("sent",c);return f}},a=function(n){var e=n.name,t=n.value;return{name:e,headers:n.headers,body:t}},f=function(n){return function(e){return function(t){return!n.deps(t).filter(I(u.in(n.subscriptions))).map(function(e){return n.subscribe(e)}).length&&e(t)}}},s=function(n){return function(e){return v(n.types).filter(function(n){return n.extract}).map(function(n){return n.extract(e)}).reduce(function(n,e){return n.concat(e)},[]).filter(Boolean)}}}),tn=(["red","green","bold","grey","strip"].forEach(function(n){!u.str(String.prototype[n])&&Object.defineProperty(String.prototype,n,{get:function(){return String(this)}})}),{header:"text/plain",check:function(n){return!f(".html")(n.name)&&!f(".css")(n.name)&&u.str(n.body)}}),rn=n(function(n){n.exports=function(){function n(t,r,o){return t?u.arr(t)?t.map(n):u.promise(t)?t.then(n).catch(a):u.obj(t)&&!t.name?n(v(t)):u.fn(t)&&t.resources?n(v(t.resources)):u.str(t)&&!r&&n.resources[t]?n.resources[t].body:!u.str(t)||r||n.resources[t]?u.str(t)&&r?e(n)({name:t,body:r,headers:o}):u.obj(t)&&!u.arr(t)?e(n)(t):(a("could not find or create resource",t),!1):void 0:n}f("creating");return n.resources={},n.resource=c(n),n.register=n,n.types=i(),M(n)};var e=function(n){return function(r){var o=r.name,i=r.body,c=r.headers;if(void 0===c&&(c={}),f("registering",o),u.promise(i))return i.then(function(t){return e(n)({name:o,body:t,headers:c})}).catch(a);var p=t(n)({name:o,body:i,headers:c});return p?(n.resources[o]=p,n.emit("change",[o,{type:"update",value:p.body,time:s(p)}]),n.resources[o].body):(a("failed to register",o),!1)}},t=function(n){return function(e){return E("content-type")(e)||v(n.types).sort(function(n){return function(e,t){var r=m(n)(e)||"",o=m(n)(t)||"";return r>o?-1:r<o?1:0}}("priority")).some(o(e)),E("content-type")(e)?r(n)(e):(a("could not understand resource",e),!1)}},r=function(n){return function(e){var t=E("content-type")(e);return n.types[t]?(n.types[t].parse||function(n){return n})(e):(a("could not understand type",t),!1)}},o=function(n){return function(e){return e.check(n)&&(n.headers["content-type"]=e.header)}},i=function(){return[tn].reduce(b.obj("header"),1)},c=function(n){return function(){return n.apply(this,arguments),n}},a=_("[ri/core]"),f=j("[ri/core]"),s=function(n,e){return e=m("body.log.length")(n),u.num(e)?e-1:e}}),on=function(n){return u.fn(n)?n:new Function("return "+n)()},un=function(n){return cn("creating"),n.on("change.data").filter(function(e){var t=e[0];e[1];return E("content-type","application/data")(n.resources[t])}).filter(function(n){n[0];var e=n[1];return e&&e.key}).map(function(e){var t=e[0],r=e[1];return n.resources[t].body.emit("change",r||null,I(u.in(["bubble"])))}),n.types["application/data"]={header:"application/data",selector:function(n){return'[data~="'+n.name+'"]'},extract:function(n){return(y("data")(n)||"").split(" ")},check:function(n){return!!u.obj(n.body)},parse:function(e){u.str(e.body)&&(e.body=on(e.body));var t=n.resources[e.name]||{};return nn(e.headers)(t.headers),e.body=Z()(e.body||[],t.body&&t.body.log,u.num(e.headers.log)?e.headers.log:-1),a(e.body.on)(an(t)),e.body.on("change.bubble",function(t){n.emit("change",n.change=[e.name,t],I(u.in(["data"]))),delete n.change}),e}},n},cn=j("[ri/types/data]"),an=m("body.on"),fn=n(function(n){n.exports=function(n){return e("creating"),n.types["text/css"]={header:"text/css",selector:function(n){return'[css~="'+n.name+'"]'},extract:function(n){return(y("css")(n)||"").split(" ")},check:function(n){return f(".css")(n.name)},parse:function(n){return n.headers.hash=t(n.body),n}},n};var e=j("[ri/types/css]"),t=function(n){for(var e=5381,t=n.length;t;)e=33*e^n.charCodeAt(--t);return e>>>0}}),sn=n(function(n){n.exports=function(n){return i("creating"),n.types["application/javascript"]={selector:e,extract:t,header:r,check:o,parse:c},n};var e=function(n){return n.name+',[is~="'+n.name+'"]'},t=function(n){return(y("is")(n)||"").split(" ").concat(O(n.nodeName))},r="application/javascript",o=function(n){return u.fn(n.body)},i=j("[ri/types/fn]"),c=function(n){return n.body=on(n.body),m("headers.transpile.limit",25)(n),n}});s&&!window.ripple&&o();return o}();
